<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тестування: Вступ до C++</title>
    <style>
        :root {
            --bg-color: #fff3e0;
            --text-color: #333;
            --primary-color: #0056b3;
            --correct-color: #d4edda;
            --correct-border: #c3e6cb;
            --wrong-color: #f8d7da;
            --wrong-border: #f5c6cb;
            --explanation-bg: #e2e3e5;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .nav-btn {
            display: inline-block;
            text-decoration: none;
            background-color: var(--primary-color);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .nav-btn:hover { background-color: #003d82; }

        /* Стилі тесту */
        .question-block {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fff;
            transition: background-color 0.3s;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .options label {
            display: block;
            margin-bottom: 8px;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid transparent;
            transition: background 0.2s;
        }

        .options label:hover {
            background-color: #f0f0f0;
        }

        input[type="radio"], input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        /* Стилі для неактивних елементів після тесту */
        input:disabled {
            cursor: not-allowed;
        }
        
        .options label.disabled-label {
            cursor: default;
            color: #555;
        }

        /* Пояснення */
        .explanation {
            display: none; /* Приховано за замовчуванням */
            margin-top: 10px;
            padding: 10px;
            background-color: var(--explanation-bg);
            border-radius: 5px;
            font-size: 0.9em;
            border-left: 4px solid #6c757d;
        }

        /* Кнопки */
        .submit-btn, .retry-btn {
            display: block;
            width: 100%;
            color: white;
            padding: 15px;
            font-size: 1.2em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 30px;
            transition: background 0.3s;
            text-align: center;
            text-decoration: none;
        }

        .submit-btn { background-color: #28a745; }
        .submit-btn:hover { background-color: #218838; }
        .submit-btn:disabled { background-color: #6c757d; cursor: not-allowed; }

        .retry-btn { background-color: #ffc107; color: #333; display: none; }
        .retry-btn:hover { background-color: #e0a800; }

        /* Інформація про спроби */
        .attempts-info {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
            color: #dc3545;
        }

        /* Результати */
        #result-area {
            margin-top: 30px;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            display: none;
        }
        
        .score-box {
            font-size: 2em;
            color: var(--primary-color);
            margin: 10px 0;
        }

        .correct-answer {
            background-color: var(--correct-color);
            border-color: var(--correct-border);
        }

        .wrong-answer {
            background-color: var(--wrong-color);
            border-color: var(--wrong-border);
        }
    </style>
</head>
<body>

    <div class="container">
        <a href="../../semester-01.html" class="nav-btn">← Назад до семестру</a>
        
        <h1>Тест 1.1: Вступ до C++</h1>
        <p style="text-align:center; color:#666; font-style:italic;">
            Питання 1-10: одна відповідь. Питання 11-12: кілька відповідей.<br>
            Всього балів: 12.
        </p>

        <div id="attempt-message" class="attempts-info"></div>

        <form id="quiz-form">
            
            <div class="question-block" id="q1">
                <div class="question-title">1. Хто вважається першим програмістом в історії?</div>
                <div class="options">
                    <label><input type="radio" name="q1" value="a"> Чарльз Беббідж</label>
                    <label><input type="radio" name="q1" value="b"> Ада Лавлейс</label>
                    <label><input type="radio" name="q1" value="c"> Білл Гейтс</label>
                    <label><input type="radio" name="q1" value="d"> Блез Паскаль</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: Ада Лавлейс.</strong> Вона написала першу програму для аналітичної машини Беббіджа ще у XIX столітті.
                </div>
            </div>

            <div class="question-block" id="q2">
                <div class="question-title">2. Що таке компілятор?</div>
                <div class="options">
                    <label><input type="radio" name="q2" value="a"> Програма, що перекладає код рядок за рядком під час виконання</label>
                    <label><input type="radio" name="q2" value="b"> Спеціальна програма для написання тексту</label>
                    <label><input type="radio" name="q2" value="c"> Програма, що перекладає весь код у машинний вигляд перед виконанням</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: Перекладає весь код.</strong> Компілятор створює окремий файл (.exe), на відміну від інтерпретатора.
                </div>
            </div>

            <div class="question-block" id="q3">
                <div class="question-title">3. Яке розширення мають файли з кодом на C++?</div>
                <div class="options">
                    <label><input type="radio" name="q3" value="a"> .py</label>
                    <label><input type="radio" name="q3" value="b"> .html</label>
                    <label><input type="radio" name="q3" value="c"> .txt</label>
                    <label><input type="radio" name="q3" value="d"> .cpp</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: .cpp.</strong> Це скорочення від "C Plus Plus".
                </div>
            </div>

            <div class="question-block" id="q4">
                <div class="question-title">4. Яка команда використовується для виведення тексту на екран у C++?</div>
                <div class="options">
                    <label><input type="radio" name="q4" value="a"> print()</label>
                    <label><input type="radio" name="q4" value="b"> cout &lt;&lt;</label>
                    <label><input type="radio" name="q4" value="c"> cin &gt;&gt;</label>
                    <label><input type="radio" name="q4" value="d"> echo</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: cout &lt;&lt;.</strong> Частина бібліотеки iostream (Character OUTput).
                </div>
            </div>

            <div class="question-block" id="q5">
                <div class="question-title">5. Яким символом завершується кожна команда в C++?</div>
                <div class="options">
                    <label><input type="radio" name="q5" value="a"> . (крапка)</label>
                    <label><input type="radio" name="q5" value="b"> : (двокрапка)</label>
                    <label><input type="radio" name="q5" value="c"> ; (крапка з комою)</label>
                    <label><input type="radio" name="q5" value="d"> , (кома)</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: ; (крапка з комою).</strong> Це обов'язковий синтаксис C++.
                </div>
            </div>

            <div class="question-block" id="q6">
                <div class="question-title">6. Яка функція є головною і обов'язковою в будь-якій програмі на C++?</div>
                <div class="options">
                    <label><input type="radio" name="q6" value="a"> start()</label>
                    <label><input type="radio" name="q6" value="b"> begin()</label>
                    <label><input type="radio" name="q6" value="c"> main()</label>
                    <label><input type="radio" name="q6" value="d"> iostream()</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: main().</strong> З цієї функції починається виконання програми.
                </div>
            </div>

            <div class="question-block" id="q7">
                <div class="question-title">7. Який тип даних використовується для цілих чисел?</div>
                <div class="options">
                    <label><input type="radio" name="q7" value="a"> float</label>
                    <label><input type="radio" name="q7" value="b"> string</label>
                    <label><input type="radio" name="q7" value="c"> int</label>
                    <label><input type="radio" name="q7" value="d"> bool</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: int.</strong> Скорочення від Integer.
                </div>
            </div>

            <div class="question-block" id="q8">
                <div class="question-title">8. Для чого використовується рядок <code>#include &lt;iostream&gt;</code>?</div>
                <div class="options">
                    <label><input type="radio" name="q8" value="a"> Для підключення бібліотеки введення-виведення</label>
                    <label><input type="radio" name="q8" value="b"> Для створення змінних</label>
                    <label><input type="radio" name="q8" value="c"> Для коментування коду</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: Підключення бібліотеки.</strong> Містить визначення для введення/виведення даних.
                </div>
            </div>

            <div class="question-block" id="q9">
                <div class="question-title">9. Яка головна відмінність C++ від Python, згадана в уроці?</div>
                <div class="options">
                    <label><input type="radio" name="q9" value="a"> C++ простіша за Python</label>
                    <label><input type="radio" name="q9" value="b"> C++ статично типізована, а Python динамічно</label>
                    <label><input type="radio" name="q9" value="c"> В C++ немає змінних</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: Типізація.</strong> У C++ тип змінної визначається заздалегідь (static typing).
                </div>
            </div>

            <div class="question-block" id="q10">
                <div class="question-title">10. Що означає <code>return 0;</code> у функції main?</div>
                <div class="options">
                    <label><input type="radio" name="q10" value="a"> Програма "впала" з помилкою</label>
                    <label><input type="radio" name="q10" value="b"> Повернути нульове значення змінній</label>
                    <label><input type="radio" name="q10" value="c"> Успішне завершення роботи програми</label>
                </div>
                <div class="explanation">
                    <strong>Правильна відповідь: Успішне завершення.</strong> Код 0 повідомляє системі про відсутність помилок.
                </div>
            </div>

            <div class="question-block" id="q11">
                <div class="question-title">11. Оберіть середовища розробки (IDE), які можна встановити на комп'ютер (оберіть 2 варіанти):</div>
                <div class="options">
                    <label><input type="checkbox" name="q11" value="a"> Visual Studio Community</label>
                    <label><input type="checkbox" name="q11" value="b"> OnlineGDB</label>
                    <label><input type="checkbox" name="q11" value="c"> Code::Blocks</label>
                    <label><input type="checkbox" name="q11" value="d"> Google Chrome</label>
                </div>
                <div class="explanation">
                    <strong>Правильні відповіді: Visual Studio та Code::Blocks.</strong> Решта варіантів - це онлайн-інструменти або браузери.
                </div>
            </div>

            <div class="question-block" id="q12">
                <div class="question-title">12. Оберіть етапи створення програми мовою C++ (оберіть 3 варіанти):</div>
                <div class="options">
                    <label><input type="checkbox" name="q12" value="a"> Написання коду (Source Code)</label>
                    <label><input type="checkbox" name="q12" value="b"> Малювання блок-схеми</label>
                    <label><input type="checkbox" name="q12" value="c"> Компіляція</label>
                    <label><input type="checkbox" name="q12" value="d"> Лінкування (Linking)</label>
                    <label><input type="checkbox" name="q12" value="e"> Архівація</label>
                </div>
                <div class="explanation">
                    <strong>Правильні відповіді: Код, Компіляція, Лінкування.</strong> Це технічні етапи перетворення тексту програми у виконуваний файл.
                </div>
            </div>

            <button type="button" id="submitBtn" class="submit-btn" onclick="checkAnswers()">Перевірити відповіді</button>
            <button type="button" id="retryBtn" class="retry-btn" onclick="location.reload()">Спробувати ще раз</button>
        </form>

        <div id="result-area">
            Ваш результат:
            <div class="score-box"><span id="score">0</span> / 12</div>
            <div id="feedback-text"></div>
        </div>
    </div>

    <script>
        // УНІКАЛЬНИЙ ID ТЕСТУ (Змінювати для кожного нового файлу: 'test_1_1', 'test_1_2'...)
        const TEST_ID = 'test_1_1_v2'; 
        const MAX_ATTEMPTS = 2;
        const LOCKOUT_TIME_MS = 12 * 60 * 60 * 1000; // 12 годин

        // Правильні відповіді
        const answers = {
            q1: 'b',
            q2: 'c',
            q3: 'd',
            q4: 'b',
            q5: 'c',
            q6: 'c',
            q7: 'c',
            q8: 'a',
            q9: 'b',
            q10: 'c',
            q11: ['a', 'c'],
            q12: ['a', 'c', 'd']
        };

        document.addEventListener('DOMContentLoaded', initTest);

        function initTest() {
            // Перемішування
            const questionBlocks = document.querySelectorAll('.question-block');
            questionBlocks.forEach(block => {
                const optionsContainer = block.querySelector('.options');
                if (optionsContainer) {
                    const labels = Array.from(optionsContainer.children);
                    for (let i = labels.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        optionsContainer.appendChild(labels[j]);
                    }
                }
            });

            checkAttemptsOnLoad();
        }

        function checkAttemptsOnLoad() {
            const attempts = parseInt(localStorage.getItem(TEST_ID + '_attempts') || '0');
            const lastAttemptTime = parseInt(localStorage.getItem(TEST_ID + '_time') || '0');
            const now = Date.now();
            const btn = document.getElementById('submitBtn');
            const msgDiv = document.getElementById('attempt-message');

            // Якщо час блокування пройшов, скидаємо
            if (attempts >= MAX_ATTEMPTS && (now - lastAttemptTime > LOCKOUT_TIME_MS)) {
                localStorage.setItem(TEST_ID + '_attempts', '0');
                localStorage.removeItem(TEST_ID + '_time');
                msgDiv.innerHTML = `Спроба 1 з ${MAX_ATTEMPTS}`;
                return;
            }

            if (attempts >= MAX_ATTEMPTS) {
                // Блокуємо, якщо спроби вичерпані
                const hoursLeft = Math.ceil((LOCKOUT_TIME_MS - (now - lastAttemptTime)) / (1000 * 60 * 60));
                disableAllInputs();
                btn.disabled = true;
                btn.textContent = `Тест заблоковано на 12 годин`;
                msgDiv.innerHTML = `Ви використали всі спроби. Наступна спроба через ${hoursLeft} год.`;
                
                // Якщо тест заблоковано, показуємо учню його попередній результат (якщо хочете)
                // Або просто залишаємо заблокованим.
            } else {
                msgDiv.innerHTML = `Спроба ${attempts + 1} з ${MAX_ATTEMPTS}`;
            }
        }

        function checkAnswers() {
            let attempts = parseInt(localStorage.getItem(TEST_ID + '_attempts') || '0');
            attempts++;
            
            // Зберігаємо нову кількість спроб
            localStorage.setItem(TEST_ID + '_attempts', attempts);
            
            let score = 0;
            const form = document.getElementById('quiz-form');
            const resultArea = document.getElementById('result-area');
            const scoreDisplay = document.getElementById('score');
            const feedbackText = document.getElementById('feedback-text');
            const submitBtn = document.getElementById('submitBtn');
            const retryBtn = document.getElementById('retryBtn');
            const msgDiv = document.getElementById('attempt-message');

            // --- 1. ПІДРАХУНОК БАЛІВ (без візуалізації) ---
            
            // Radio
            for (let i = 1; i <= 10; i++) {
                const qId = 'q' + i;
                const selected = form.elements[qId].value;
                if (selected === answers[qId]) score++;
            }

            // Checkbox
            function checkMulti(qId, correctArr) {
                const checkboxes = document.querySelectorAll(`input[name="${qId}"]:checked`);
                let selectedValues = [];
                checkboxes.forEach((cb) => selectedValues.push(cb.value));
                selectedValues.sort();
                correctArr.sort();
                if (JSON.stringify(selectedValues) === JSON.stringify(correctArr)) score++;
            }
            checkMulti('q11', answers.q11);
            checkMulti('q12', answers.q12);

            // Показуємо сам бал
            scoreDisplay.textContent = score;
            resultArea.style.display = 'block';
            
            // Визначаємо, чи це остання спроба або ідеальний результат
            const isFinalAttempt = (attempts >= MAX_ATTEMPTS);
            const isPerfectScore = (score === 12);
            
            // --- 2. ЛОГІКА ВІДОБРАЖЕННЯ ---

            if (isPerfectScore || isFinalAttempt) {
                // ВАРІАНТ А: Показуємо все (зелене/червоне + пояснення)
                
                if (isFinalAttempt) {
                    localStorage.setItem(TEST_ID + '_time', Date.now()); // Ставимо таймер
                    msgDiv.innerHTML = "Спроби вичерпано. Правильні відповіді відкриті.";
                }

                // Зафарбовуємо відповіді
                for (let i = 1; i <= 10; i++) {
                    const qId = 'q' + i;
                    const block = document.getElementById(qId);
                    const selected = form.elements[qId].value;
                    if (selected === answers[qId]) block.classList.add('correct-answer');
                    else block.classList.add('wrong-answer');
                }
                
                // Для чекбоксів складніше зафарбувати, тому просто підсвічуємо блок
                function highlightMulti(qId, correctArr) {
                    const block = document.getElementById(qId);
                    const checkboxes = document.querySelectorAll(`input[name="${qId}"]:checked`);
                    let selectedValues = [];
                    checkboxes.forEach((cb) => selectedValues.push(cb.value));
                    selectedValues.sort();
                    correctArr.sort();
                    if (JSON.stringify(selectedValues) === JSON.stringify(correctArr)) block.classList.add('correct-answer');
                    else block.classList.add('wrong-answer');
                }
                highlightMulti('q11', answers.q11);
                highlightMulti('q12', answers.q12);

                // Показуємо пояснення
                document.querySelectorAll('.explanation').forEach(el => el.style.display = 'block');
                
                // Текст результату
                if (score === 12) {
                    resultArea.style.backgroundColor = '#d4edda';
                    resultArea.style.color = '#155724';
                    feedbackText.textContent = "Вітаємо! Ідеальний результат.";
                } else {
                    resultArea.style.backgroundColor = '#f8d7da';
                    resultArea.style.color = '#721c24';
                    feedbackText.textContent = "Тест завершено. Перегляньте помилки та пояснення нижче.";
                }

                disableAllInputs();
                submitBtn.disabled = true;
                submitBtn.textContent = "Тест завершено";

            } else {
                // ВАРІАНТ Б: Перша спроба з помилками (Сліпий режим)
                
                resultArea.style.backgroundColor = '#fff3cd'; // Жовтий колір
                resultArea.style.color = '#856404';
                feedbackText.textContent = "Ви не набрали максимальний бал. Правильні відповіді приховані, щоб ви могли подумати ще раз.";
                
                // Ховаємо кнопку перевірки, показуємо кнопку "Спробувати ще раз"
                submitBtn.style.display = 'none';
                retryBtn.style.display = 'block';
                
                // Блокуємо інпути, щоб учень мусив натиснути "Спробувати ще раз" (reload)
                const inputs = document.querySelectorAll('input');
                inputs.forEach(input => input.disabled = true);
                
                msgDiv.innerHTML = `Ви використали 1 спробу з ${MAX_ATTEMPTS}.`;
            }

            resultArea.scrollIntoView({ behavior: 'smooth' });
        }

        function disableAllInputs() {
            const inputs = document.querySelectorAll('input');
            const labels = document.querySelectorAll('.options label');
            inputs.forEach(input => input.disabled = true);
            labels.forEach(label => label.classList.add('disabled-label'));
        }
    </script>
</body>
</html>
